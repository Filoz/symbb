{% trans_default_domain "symbb_frontend" %}

{% macro showPostList(object, pagination) %}

    {% for post in pagination %}
        <div class="row symbb_header_bg {% if loop.first %} header {% else %} subheader {% endif %}">
            <div class="col-md-12">{{post.getName()}}
                <div class="f-right">
                    <div class="btn-group btn-group-xs">
                        <button type="button" class="btn btn-default" onclick="window.location.href='#symbb_bbcode_editor';">{% trans %}Answer{% endtrans %}</button>
                        <button type="button" class="btn btn-default quote" data-user="{{post.getAuthor().getUsername()}}" data-quote="{{post.getText()}}" >{% trans %}Quote{% endtrans %}</button>
                        {% if hasSymbbAccess('EDIT', post) %}
                        <button type="button" class="btn btn-default btn-primary" onclick="window.location.href='{{ path('_symbb_edit_post', {'name': post.getTopic().getSeoName(), 'topic': post.getTopic().getId(), 'post': post.getId()}) }}'">{% trans %}Edit{% endtrans %}</button>
                        {% endif %}
                        {% if hasSymbbAccess('DELETE', post) %}
                        <button type="button" class="btn btn-default btn-danger" onclick="if (confirm('{% trans %}you really want to delete the entry?{% endtrans %}')) { window.location.href='{{ path('_symbb_delete_post', {'post': post.getId()}) }}' };" >{% trans %}Delete{% endtrans %}</button>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        <div class="row body">
            <div class="col-md-3 userblock">
                {{ executeSymbbEvent('before.avatar', post) }}
                <div class="avatar">
                    <img src="{{getSymbbUserAvatar(post.getAuthor())}}" />
                </div>
                {{ executeSymbbEvent('after.avatar', post) }}
                {{ executeSymbbEvent('before.username', post) }}
                {{post.getAuthor().getUsername()}}
                {{ executeSymbbEvent('after.username', post) }}
            </div>
            <div class="col-md-9 textblock">
                <div class="date">
                    {% trans with {'%user%': post.getAuthor().getUsername(), '%date%': post.getChanged()|format_date, '%time%': post.getChanged()|date('H:i')} %}%user% wrote on %date% at %time%{% endtrans %}
                </div>
                {{ executeSymbbEvent('before.text', post) }}
                <div class="text" id="symbb_post_body_{{post.getId()}}">
                {{post.getText()|bbcode_filter('default')}}
                </div>
                {{ executeSymbbEvent('after.text', post) }}
                {{ executeSymbbEvent('before.signature', post) }}
                {{ _self.showSignature(post) }}
                {{ executeSymbbEvent('after.signature', post) }}
            </div>
        </div>
    {% endfor %}

{% endmacro %}

{% macro showSignature(object) %}
{% if getSymbbUserData(object.getAuthor()).hasSignature() %}
    <div class="row signature">
        {{getSymbbUserSignature(object.getAuthor())|bbcode_filter('signature')}}
    </div>
{% endif %}
{% endmacro %}